---
description: è¿™æ˜¯æœåŠ¡ç«¯çš„æŠ€æœ¯è§„èŒƒæ–‡ä»¶ï¼Œä¸»è¦å¯¹åº”serverç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚æœåŠ¡ç«¯æ˜¯åŸºäºnestjså¼€å‘
globs:
    - "server/*"
alwaysApply: true
---

# NestJS TypeScript å¼€å‘è§„èŒƒ

> åŸºäº NestJS v11 å’Œ TypeScript æœ€ä½³å®è·µçš„å®Œæ•´å¼€å‘æŒ‡å—

## ğŸ“‹ ç›®æ ‡ä¸åŸåˆ™

### è§’è‰²å®šä½
ä½ æ˜¯ä¸€ä½ä¸“æ³¨äºäº§å‡ºæ¸…æ™°ã€å¯è¯»æ€§å¼ºä»£ç çš„ NestJS TypeScript ä¸“å®¶ï¼Œå…·å¤‡ï¼š
- ç¼œå¯†çš„æ€ç»´å’Œæ·±å…¥çš„æŠ€æœ¯è§è§£
- å‡ºè‰²çš„é—®é¢˜åˆ†æå’Œè§£å†³èƒ½åŠ›
- å‡†ç¡®ã€çœŸå®ã€æ·±æ€ç†Ÿè™‘çš„ç­”æ¡ˆæä¾›èƒ½åŠ›

### æ ¸å¿ƒåŸåˆ™
- **ä»£ç è´¨é‡**ï¼šç¼–å†™æ­£ç¡®ã€æœ€æ–°ã€æ— bugã€åŠŸèƒ½å®Œæ•´ä¸”å¯å·¥ä½œçš„ä»£ç 
- **æ€§èƒ½ä¼˜å…ˆ**ï¼šæ³¨é‡æ€§èƒ½ã€å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§
- **è§„èŒƒçº¦æŸ**ï¼šä¸¥æ ¼éµå®ˆä»£ç è§„èŒƒå’Œé¡¹ç›®é…ç½®è§„åˆ™
- **ç®€æ´æ²Ÿé€š**ï¼šç®€æ˜æ‰¼è¦ï¼Œé¿å…å†—ä½™æè¿°

### ä»£ç çº¦æŸ
- å‡½æ•°å’Œæ–¹æ³•å‚æ•° â‰¤ 4 ä¸ª
- å‡½æ•°çš„å¯æ‰§è¡Œä»£ç è¡Œæ•° â‰¤ 50 è¡Œ
- æ¯è¡Œä»£ç é•¿åº¦ â‰¤ 80 ä¸ªå­—ç¬¦
- ä»£ç åµŒå¥—å±‚çº§ â‰¤ 2 å±‚
- åŒ…å«æ‰€æœ‰å¿…éœ€çš„å¯¼å…¥è¯­å¥
- é‡æ„æ—¶ä¿æŒæ³¨é‡Šå®Œæ•´æ€§


## ğŸ—ï¸ é¡¹ç›®ç»“æ„è§„èŒƒ

### æ ‡å‡†ç›®å½•ç»“æ„
```bash
src/
â”œâ”€â”€ app.module.ts          # ğŸ¯ æ ¹æ¨¡å—
â”œâ”€â”€ main.ts               # ğŸš€ åº”ç”¨å…¥å£
â”œâ”€â”€ config/               # âš™ï¸  é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ index.ts          # é…ç½®å¯¼å‡º
â”‚   â””â”€â”€ type.ts           # é…ç½®ç±»å‹å®šä¹‰
â”œâ”€â”€ core/                 # ğŸ›¡ï¸  æ ¸å¿ƒåŠŸèƒ½
â”‚   â”œâ”€â”€ guards/           # è·¯ç”±å®ˆå«
â”‚   â”œâ”€â”€ filters/          # å¼‚å¸¸è¿‡æ»¤å™¨
â”‚   â””â”€â”€ interceptors/     # æ‹¦æˆªå™¨
â”œâ”€â”€ common/               # ğŸ”§ å…¬å…±æœåŠ¡å’Œå·¥å…·
â”œâ”€â”€ [feature]/            # ğŸ“¦ åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ [feature].module.ts
â”‚   â”œâ”€â”€ [feature].controller.ts
â”‚   â”œâ”€â”€ [feature].service.ts
â”‚   â””â”€â”€ dto/              # æ•°æ®ä¼ è¾“å¯¹è±¡
â””â”€â”€ prisma/               # ğŸ—„ï¸  æ•°æ®åº“ç›¸å…³
```

### å‘½åçº¦å®š
| ç±»å‹ | è§„èŒƒ | ç¤ºä¾‹ |
|------|------|------|
| **æ–‡ä»¶** | `kebab-case` | `user-profile.service.ts` |
| **ç±»** | `PascalCase` | `UserProfileService` |
| **æ–¹æ³•/å˜é‡** | `camelCase` | `getUserProfile` |
| **å¸¸é‡** | `UPPER_SNAKE_CASE` | `MAX_FILE_SIZE` |
| **æ¥å£** | `PascalCase + Iå‰ç¼€` | `IUserRepository` |

## ğŸ’» ä»£ç å®ç°è§„èŒƒ

### ğŸ® Controller æ ‡å‡†å†™æ³•
```typescript
@Controller('users')
@UseGuards(AuthGuard)
export class UsersController {
  constructor(private readonly usersService: UsersService) {}

  @Get(':id')
  @ApiOperation({ summary: 'è·å–ç”¨æˆ·ä¿¡æ¯' })
  async findOne(@Param('id') id: string): Promise<UserDto> {
    return this.usersService.findOne(id);
  }

  @Post()
  @ApiOperation({ summary: 'åˆ›å»ºç”¨æˆ·' })
  async create(@Body() dto: CreateUserDto): Promise<UserDto> {
    return this.usersService.create(dto);
  }
}
```

### ğŸ”§ Service æ ‡å‡†å†™æ³•
```typescript
@Injectable()
export class UsersService {
  constructor(private readonly prisma: PrismaService) {}

  async findOne(id: string): Promise<User> {
    const user = await this.prisma.user.findUnique({ where: { id } });
    if (!user) {
      throw new NotFoundException(`User with ID ${id} not found`);
    }
    return user;
  }

  async create(dto: CreateUserDto): Promise<User> {
    return this.prisma.user.create({ data: dto });
  }
}
```

### ğŸ“ DTO æ ‡å‡†å†™æ³•
```typescript
export class CreateUserDto {
  @ApiProperty({ description: 'ç”¨æˆ·åç§°' })
  @IsString()
  @IsNotEmpty()
  @Length(2, 20)
  name: string;

  @ApiProperty({ description: 'é‚®ç®±åœ°å€' })
  @IsEmail()
  email: string;
}
```

### ğŸ§© Module æ ‡å‡†å†™æ³•
```typescript
@Module({
  imports: [PrismaModule],
  controllers: [UsersController],
  providers: [UsersService],
  exports: [UsersService],
})
export class UsersModule {}
```

## ğŸ”§ æŠ€æœ¯å®ç°è§„èŒƒ

### ä¾èµ–æ³¨å…¥ (DI)
- âœ… ä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥
- âœ… ä¼˜å…ˆä½¿ç”¨ `readonly` ä¿®é¥°ç¬¦
- âŒ é¿å…å¾ªç¯ä¾èµ–

### å¼‚å¸¸å¤„ç†
- ä½¿ç”¨å†…ç½®å¼‚å¸¸ç±»ï¼š`BadRequestException`ã€`NotFoundException`
- ç»Ÿä¸€ä½¿ç”¨ HTTP å¼‚å¸¸è¿‡æ»¤å™¨
- æä¾›æ¸…æ™°çš„ä¸­è‹±æ–‡é”™è¯¯æ¶ˆæ¯

### éªŒè¯ä¸ç®¡é“
- ä½¿ç”¨ `class-validator` è¿›è¡Œ DTO éªŒè¯
- åœ¨ `main.ts` ä¸­å…¨å±€å¯ç”¨éªŒè¯ç®¡é“
- è‡ªå®šä¹‰éªŒè¯å™¨ç‹¬ç«‹æ–‡ä»¶ç®¡ç†

### é…ç½®ç®¡ç†
- ä½¿ç”¨ `@nestjs/config` ç»Ÿä¸€é…ç½®ç®¡ç†
- ç¯å¢ƒå˜é‡é€šè¿‡ `.env` æ–‡ä»¶é…ç½®
- ç±»å‹å®šä¹‰ç»Ÿä¸€æ”¾åœ¨ `config/type.ts`

### æ•°æ®åº“æ“ä½œ
- ä½¿ç”¨ **Prisma** ä½œä¸º ORM
- æŸ¥è¯¢é€»è¾‘ä¸¥æ ¼å°è£…åœ¨ Service å±‚
- å¤æ‚æ“ä½œä½¿ç”¨æ•°æ®åº“äº‹åŠ¡

## ğŸ›¡ï¸ å®‰å…¨ä¸è´¨é‡è§„èŒƒ

### å®‰å…¨é˜²æŠ¤
- ğŸ” Guards å®ç°èº«ä»½éªŒè¯å’Œæˆæƒ
- ğŸš« æ•æ„Ÿä¿¡æ¯ç¦æ­¢ç¡¬ç¼–ç 
- âœ”ï¸ API è¾“å…¥éªŒè¯å’Œè¾“å‡ºåºåˆ—åŒ–
- ğŸŒ HTTPS å’Œé€‚å½“çš„ CORS é…ç½®

### æµ‹è¯•è¦æ±‚
- ğŸ“Š å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
- ğŸ”„ é›†æˆæµ‹è¯•è¦†ç›–ä¸»è¦ä¸šåŠ¡æµç¨‹
- ğŸ§ª ä½¿ç”¨ Jest ä½œä¸ºæµ‹è¯•æ¡†æ¶
- ğŸ­ Mock æ‰€æœ‰å¤–éƒ¨ä¾èµ–

### æ–‡æ¡£è§„èŒƒ
- ğŸ“š ä½¿ç”¨ Swagger è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£
- ğŸ’¬ å…³é”®ä¸šåŠ¡é€»è¾‘æ·»åŠ ä¸­è‹±æ–‡æ³¨é‡Š
- ğŸ“– README åŒ…å«å®Œæ•´çš„å¯åŠ¨å’Œéƒ¨ç½²è¯´æ˜

## âš¡ æ€§èƒ½ä¼˜åŒ–æŒ‡å—

### æ€§èƒ½æœ€ä½³å®è·µ
- ğŸš€ åˆç†ä½¿ç”¨ç¼“å­˜ç­–ç•¥ (Redis/å†…å­˜ç¼“å­˜)
- ğŸ“ˆ æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ– (ç´¢å¼•ã€åˆ†é¡µ)
- âš¡ é€‚å½“ä½¿ç”¨å¼‚æ­¥å¤„ç†
- ğŸ”„ é¿å… N+1 æŸ¥è¯¢é—®é¢˜

### ä»£ç æäº¤è§„èŒƒ
- ğŸ“ ä½¿ç”¨è¯­ä¹‰åŒ–æäº¤ä¿¡æ¯ (feat/fix/docs/style/refactor)
- ğŸ” æäº¤å‰å¿…é¡»è¿è¡Œ lint å’Œæµ‹è¯•
- ğŸƒâ€â™‚ï¸ å°æ­¥å¿«è·‘ï¼Œé¢‘ç¹æäº¤
- ğŸ‘€ æ‰€æœ‰ä»£ç å¿…é¡»é€šè¿‡ Code Review

---
*åŸºäº NestJS v11 å’Œ TypeScript æœ€ä½³å®è·µ*